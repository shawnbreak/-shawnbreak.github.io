---
title: dhcp
---

# dhcp

## Install

```sh
yum install dhcp
```

## Start

```sh
systemctl start dhcpd
```

## Help

```sh
man dhcpd
```



## 配置

/etc/dhcp/dhcpd.conf

- Subnet Declaration

```sh
subnet 192.168.1.0 netmask 255.255.255.0 {
    option routers 192.168.1.254;
    option subnet-mask 255.255.255.0;
    option domain-search "example.com";
    option domain-name-servers 192.168.1.1;
    option time-offset -18000; # Eastern Standard Time
    range 192.168.1.10 192.168.1.100;
}
```

- Range Parameter

```sh
default-lease-time 600;
max-lease-time 7200;
option subnet-mask 255.255.255.0;
option broadcast-address 192.168.1.255;
option routers 192.168.1.254;
option domain-name-servers 192.168.1.1, 192.168.1.2;
option domain-search "example.com";
subnet 192.168.1.0 netmask 255.255.255.0 {
	range 192.168.1.10 192.168.1.100;
}
```

- Static IP Address Using DHCP

```sh
host apex {
    option host-name "apex.example.com";
    hardware ethernet 00:A0:78:8E:9E:AA;
    fixed-address 192.168.1.4;
}
```

- Static IP Address Using DHCP on Multiple Interfaces

```sh
Host apex.0 {
    option host-name “apex.example.com”;
    hardware ethernet 00:A0:78:8E:9E:AA;
    option dhcp-client-identifier=ff:00:00:00:00:00:02:00:00:02:c9:00:00:02:c9:03:00:31:7b:11;
    fixed-address 172.31.0.50,172.31.2.50,172.31.1.50,172.31.3.50;
}
```



# DNS

## 安装

```sh
yum install bind-chroot
systemctl status named
systemctl start named
```



## 配置

- /etc/named.conf

将监听地址和运行查询的地址都改为 any，分别表示服务器上的所有IP地址均可提供DNS域名解析服务，以及允许所有人对本服务器发送DNS查询请求。

```sh
listen-on port 53 { any; };
```

- **/etc/named.rfc1912.zones**

用来保存域名和IP地址对应关系的所在位置

```sh
zone "example.com" IN {
        type master;
        file "example.com.zone";
};
```

- /var/named/example.com.zone

```sh
$TTL 1D
@       IN SOA  @ example.com. (
                                        0       ; serial
                                        1D      ; refresh
                                        1H      ; retry
                                        1W      ; expire
                                        3H )    ; minimum
        NS      @
        A       192.168.86.128
        AAAA    ::1
```

## 检查配置，重启服务

```sh
named-checkconf
named-checkzone eample.com /var/named/example.com.zone 
```



```sh
vi /etc/resolv.conf
#进入该配置文件，指定使用的域名解析服务器。
# Generated by NetworkManager
nameserver 192.168.245.128
search 192.168.245.128
```

重启服务

```sh
systemctl restart named
```

# squid

squid是一个代理服务器，可以用作内容缓存，提高访问速度。

## 安装

```sh
yum install squid
```



## 配置缓存代理服务器

 /etc/squid/squid.conf

```sh
acl localnet src 192.0.2.0/24
acl localnet 2001:db8::/32
acl SSL_ports port 443
acl Safe_ports port 21
acl Safe_ports port 80
acl Safe_ports port 443
cache_dir ufs /var/spool/squid 10000 16 256
```

## 启动

```sh
systemctl start squid
```

